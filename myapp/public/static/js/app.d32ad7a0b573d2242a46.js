webpackJsonp([1],{"+skl":function(t,e){},0:function(t,e){},"7aCj":function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("7+uW"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var o=n("VU/8")({name:"App"},i,!1,function(t){n("7aCj")},null,null).exports,s=n("/ocq"),r={name:"admim",data:function(){return{newQuest:{phoneNumber:"",desc:""},currentPointer:"",secretNumber:"",startNew:!1,startNewLoading:!0,locationInfo:"",currentItem:0,numberList:[]}},sockets:{connect:function(){console.log("socket connected")},map:function(t){this.$Message.info("电话号码为"+t.msg.phoneNumber+"的位置信息更新了");for(var e=0;e<this.numberList.length;e++)if(t.msg.phoneNumber===this.currentPointer&&this.numberList[e].phoneNumber===this.currentPointer){this.numberList[e]=t.msg,this.secretNumber="http://120.78.79.229:3000/#/client/"+this.numberList[e].secretNumber;var n=JSON.parse(this.numberList[e].location);this.locationInfo=n.formattedAddress,this.drawMarker(n)}}},methods:{changeItem:function(t){this.currentPointer=t;for(var e=0;e<this.numberList.length;e++)if(this.secretNumber="http://120.78.79.229:3000/#/client/"+this.numberList[e].secretNumber,t===this.numberList[e].phoneNumber)if("unknow"===this.numberList[e].location){this.locationInfo="等待确认";new AMap.Map("container",{resizeEnable:!0,zoom:11,center:[104.09659999999997,30.67394]})}else{var n=JSON.parse(this.numberList[e].location);this.locationInfo=n.formattedAddress,this.drawMarker(n)}},createMap:function(){new AMap.Map("container",{resizeEnable:!0,zoom:11,center:[104.09659999999997,30.67394]})},drawMarker:function(t){var e=[];e[1]=t.position.Q,e[0]=t.position.R;var n=new AMap.Map("container",{resizeEnable:!0,zoom:11,center:[104.09659999999997,30.67394]}),a=new AMap.Marker({icon:"https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",position:e});n.add(a),n.setFitView()},getsocket:function(){this.$socket.emit("client message","admin")},startNewModal:function(){this.startNew=!0},cancleNew:function(){this.startNew=!1},isPoneAvailable:function(t){return!!/^[1][3,4,5,7,8][0-9]{9}$/.test(t)},sendNewQuest:function(){var t=this,e=!1,n=this;""===this.newQuest.phoneNumber&&(this.$Message.error("电话号码不能为空"),e=!0),this.isPoneAvailable(this.newQuest.phoneNumber)||(this.$Message.error("请输入正确的电话号码"),e=!0),e?setTimeout(function(){t.startNewLoading=!1,t.$nextTick(function(){n.startNewLoading=!0})},1e3):this.$axios({method:"post",url:"http://120.78.79.229:3000/admin",data:{data:n.newQuest}}).then(function(e){t.$Message.info("新建成功"),t.startNew=!1,t.getData()}).catch(function(e){t.$Message.error("新建失败"),t.startNew=!1})},getData:function(){var t=this;this.$axios({method:"get",url:"http://120.78.79.229:3000/admin/getList"}).then(function(e){console.log(e),t.numberList=e.data}).catch(function(e){t.$Message.error("新建失败")})}},mounted:function(){this.createMap(),this.getData()}},c={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"layout"},[n("Layout",{staticStyle:{height:"100%"}},[n("Header",[n("Menu",{attrs:{mode:"horizontal",theme:"dark"}},[n("div",{staticClass:"headerTitle"},[t._v("眉山消防定位系统")]),t._v(" "),n("div",{staticClass:"layout-nav"})])],1),t._v(" "),n("Layout",[n("Sider",{style:{background:"#fff"},attrs:{"hide-trigger":""}},[n("Menu",{attrs:{theme:"light",width:"auto","open-names":["1"],"active-name":t.currentItem},on:{"on-select":t.changeItem}},[n("Submenu",{attrs:{name:"1"}},[n("template",{slot:"title"},[t._v("\n                            报警人员列表\n                        ")]),t._v(" "),t._l(t.numberList,function(e,a){return n("div",{key:a},[n("MenuItem",{attrs:{name:e.phoneNumber}},[t._v(t._s(e.phoneNumber)+"\n                            "),n("Button",{attrs:{type:"error",size:"small"},on:{click:t.getsocket}},[t._v("删除")])],1)],1)}),t._v(" "),n("Button",{staticStyle:{margin:"20px 0 0 40px"},attrs:{type:"primary"},on:{click:t.startNewModal}},[t._v("新建火灾信息")])],2)],1)],1),t._v(" "),n("Layout",{staticStyle:{position:"relative"}},[n("div",{staticStyle:{width:"100%",height:"100%"},attrs:{id:"container"}}),t._v(" "),n("Card",{staticClass:"infoCard"},[n("p",{attrs:{slot:"title"},slot:"title"},[t._v("\n                      具体位置信息:\n                  ")]),t._v(" "),n("p",[t._v(t._s(this.locationInfo))]),t._v(" "),n("p",{staticStyle:{"word-wrap":"break-word"}},[t._v("位置确认url:"+t._s(this.secretNumber))])])],1)],1)],1),t._v(" "),n("Modal",{attrs:{loading:t.startNewLoading},on:{"on-cancle":t.cancleNew,"on-ok":t.sendNewQuest},model:{value:t.startNew,callback:function(e){t.startNew=e},expression:"startNew"}},[n("p",[t._v("报警人电话:"),n("Input",{staticStyle:{width:"200px"},model:{value:t.newQuest.phoneNumber,callback:function(e){t.$set(t.newQuest,"phoneNumber",e)},expression:"newQuest.phoneNumber"}})],1),t._v(" "),n("p",[t._v("报警人信息位置描述:"),n("Input",{attrs:{type:"textarea"},model:{value:t.newQuest.desc,callback:function(e){t.$set(t.newQuest,"desc",e)},expression:"newQuest.desc"}})],1)])],1)},staticRenderFns:[]};var u=n("VU/8")(r,c,!1,function(t){n("iyLd")},"data-v-37ebbba2",null).exports,l={name:"client",data:function(){return{info:"定位中，请等待"}},methods:{getLocation:function(){var t=this;AMap.plugin("AMap.Geolocation",function(){new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonPosition:"RB",buttonOffset:new AMap.Pixel(10,20),zoomToAccuracy:!0}).getCurrentPosition(function(e,n){"complete"==e?t.onComplete(n):t.info="定位失败"})})},onComplete:function(t){var e=this,n=this.$route.params.number;this.$axios({method:"post",url:"http://120.78.79.229:3000/client?number="+n,data:{data:t}}).then(function(t){e.info="定位成功"}).catch(function(t){e.info="网络失败"})}},mounted:function(){this.getLocation()}},m={render:function(){var t=this.$createElement;return(this._self._c||t)("div",[this._v(this._s(this.info))])},staticRenderFns:[]};var h=n("VU/8")(l,m,!1,function(t){n("ZQJW")},"data-v-cb8408ca",null).exports;a.default.use(s.a);var p=new s.a({routes:[{path:"/admin",name:"admin",component:u},{path:"/client/:number",name:"client",component:h}]}),d=n("BTaQ"),f=n.n(d),v=(n("+skl"),n("mtWM")),b=n.n(v),w=(n("Rf8U"),n("HI0L")),g=n.n(w);n("DmT9");a.default.config.productionTip=!1,a.default.use(f.a),a.default.use(new g.a({debug:!1,connection:"http://120.78.79.229:3000"})),a.default.prototype.$axios=b.a,new a.default({el:"#app",router:p,components:{App:o},template:"<App/>"})},ZQJW:function(t,e){},iyLd:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.d32ad7a0b573d2242a46.js.map